/******************************************************************************/
/****     Generated by IBExpert 2015.12.21.1 28/12/2018 12:13:02 a. m.     ****/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES ISO8859_1;

SET CLIENTLIB 'C:\app\server\fbclient.dll';

CREATE DATABASE '127.0.0.1:C:\app\data\proceso.fdb'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET ISO8859_1 COLLATION ISO8859_1;



/******************************************************************************/
/****                              Generators                              ****/
/******************************************************************************/

CREATE GENERATOR UC_LOG_ID_SEQ;
SET GENERATOR UC_LOG_ID_SEQ TO 1;

CREATE GENERATOR UC_MESSENGER_ID_SEQ;
SET GENERATOR UC_MESSENGER_ID_SEQ TO 1;

CREATE GENERATOR UC_MONITOR_ID_SEQ;
SET GENERATOR UC_MONITOR_ID_SEQ TO 1;

CREATE GENERATOR UC_PARAMETERS_ID_SEQ;
SET GENERATOR UC_PARAMETERS_ID_SEQ TO 9;

CREATE GENERATOR UC_RIGHTSEX_ID_SEQ;
SET GENERATOR UC_RIGHTSEX_ID_SEQ TO 1;

CREATE GENERATOR UC_RIGHTS_ID_SEQ;
SET GENERATOR UC_RIGHTS_ID_SEQ TO 139;

CREATE GENERATOR UC_USERSLOGGED_ID_SEQ;
SET GENERATOR UC_USERSLOGGED_ID_SEQ TO 137;

CREATE GENERATOR UC_USERS_ID_SEQ;
SET GENERATOR UC_USERS_ID_SEQ TO 2;



/******************************************************************************/
/****                                Tables                                ****/
/******************************************************************************/



CREATE TABLE ALMACEN (
    IDALMACEN    VARCHAR(38) NOT NULL,
    CODE         INTEGER,
    NAME         VARCHAR(10),
    DESCRIPCION  VARCHAR(50),
    CONTENEDOR   VARCHAR(10),
    GRUPO        VARCHAR(10)
);


CREATE TABLE CAPTURA (
    FOLIO      VARCHAR(38) NOT NULL,
    IDALMACEN  INTEGER,
    FECHA      TIMESTAMP,
    ETAPA      INTEGER
);


CREATE TABLE DOCS (
    IDCAPTURA  VARCHAR(38) NOT NULL,
    FOLIO      VARCHAR(10),
    ETAPA      INTEGER,
    NAME       VARCHAR(50),
    DOC        BLOB SUB_TYPE 0 SEGMENT SIZE 80
);


CREATE TABLE ETAPA (
    IDETAPA      VARCHAR(38) CHARACTER SET NONE NOT NULL,
    CODE         INTEGER,
    NAME         VARCHAR(20),
    DESCRIPCION  VARCHAR(50),
    CONTENEDOR   VARCHAR(10),
    GRUPO        VARCHAR(10),
    ADJUNTAR     SMALLINT
);


CREATE TABLE UC_LOG (
    ID             INTEGER NOT NULL,
    APPLICATIONID  VARCHAR(50),
    USERID         INTEGER,
    "MESSAGE"      VARCHAR(255),
    LOGDATE        TIMESTAMP,
    LOGLEVEL       INTEGER
);


CREATE TABLE UC_MESSENGER (
    ID             INTEGER NOT NULL,
    USERIDFROM     INTEGER,
    USERIDTO       INTEGER,
    SUBJECT        VARCHAR(50),
    "MESSAGE"      BLOB SUB_TYPE 1 SEGMENT SIZE 1024,
    SENDDATE       TIMESTAMP,
    RECEIVEDATE    TIMESTAMP,
    RETURNRECEIPT  INTEGER,
    IMPORTANT      INTEGER
);


CREATE TABLE UC_MONITOR (
    ID             INTEGER NOT NULL,
    APPLICATIONID  VARCHAR(50),
    USERID         INTEGER,
    EVENTDATE      TIMESTAMP,
    FORMNAME       VARCHAR(250),
    FORMCAPTION    VARCHAR(100),
    "EVENT"        CHAR(1),
    DATA           BLOB SUB_TYPE 1 SEGMENT SIZE 1024,
    DATASETNAME    VARCHAR(50)
);


CREATE TABLE UC_PARAMETERS (
    ID          INTEGER NOT NULL,
    PARAMNAME   VARCHAR(64),
    PARAMTYPE   INTEGER,
    PARAMVALUE  BLOB SUB_TYPE 1 SEGMENT SIZE 1024
);


CREATE TABLE UC_RIGHTS (
    ID              INTEGER NOT NULL,
    USERID          INTEGER,
    APPLICATIONID   VARCHAR(50),
    COMPONENTNAME   VARCHAR(50),
    RECORDCHECKSUM  CHAR(32)
);


CREATE TABLE UC_RIGHTSEX (
    ID              INTEGER NOT NULL,
    USERID          INTEGER,
    APPLICATIONID   VARCHAR(50),
    COMPONENTNAME   VARCHAR(50),
    CONTAINERNAME   VARCHAR(50),
    RECORDCHECKSUM  CHAR(32)
);


CREATE TABLE UC_USERS (
    ID                       INTEGER NOT NULL,
    NAME                     VARCHAR(30),
    USERNAME                 VARCHAR(30),
    "PASSWORD"               CHAR(32),
    PASSWORDEXPIRATIONDATE   DATE,
    PASSWORDEXPIRATIONCOUNT  INTEGER,
    PASSWORDVALIDITY         INTEGER,
    EMAIL                    VARCHAR(150),
    RECORDTYPE               CHAR(1),
    PROFILEID                INTEGER,
    RECORDCHECKSUM           CHAR(32),
    ADDITIONALATTRIBUTES     INTEGER,
    "INACTIVE"               INTEGER,
    EXTERNALID               INTEGER
);


CREATE TABLE UC_USERSLOGGED (
    ID             INTEGER NOT NULL,
    LOGONID        CHAR(38),
    USERID         INTEGER,
    APPLICATIONID  VARCHAR(50),
    MACHINENAME    VARCHAR(50),
    LOGONDATE      TIMESTAMP
);




/******************************************************************************/
/****                          Unique constraints                          ****/
/******************************************************************************/

ALTER TABLE UC_PARAMETERS ADD CONSTRAINT UC_PARAMETERS_PARAMNAME_UK UNIQUE (PARAMNAME);


/******************************************************************************/
/****                             Primary keys                             ****/
/******************************************************************************/

ALTER TABLE ALMACEN ADD CONSTRAINT PK_ALMACEN PRIMARY KEY (IDALMACEN);
ALTER TABLE CAPTURA ADD CONSTRAINT PK_CAPTURA PRIMARY KEY (FOLIO);
ALTER TABLE DOCS ADD CONSTRAINT PK_DOCS PRIMARY KEY (IDCAPTURA);
ALTER TABLE ETAPA ADD CONSTRAINT PK_ETAPA PRIMARY KEY (IDETAPA);
ALTER TABLE UC_LOG ADD CONSTRAINT UC_LOG_PK PRIMARY KEY (ID);
ALTER TABLE UC_MESSENGER ADD CONSTRAINT UC_MESSENGER_PK PRIMARY KEY (ID);
ALTER TABLE UC_MONITOR ADD CONSTRAINT UC_MONITOR_PK PRIMARY KEY (ID);
ALTER TABLE UC_PARAMETERS ADD CONSTRAINT UC_PARAMETERS_PK PRIMARY KEY (ID);
ALTER TABLE UC_RIGHTS ADD CONSTRAINT UC_RIGHTS_PK PRIMARY KEY (ID);
ALTER TABLE UC_RIGHTSEX ADD CONSTRAINT UC_RIGHTSEX_PK PRIMARY KEY (ID);
ALTER TABLE UC_USERS ADD CONSTRAINT UC_USERS_PK PRIMARY KEY (ID);
ALTER TABLE UC_USERSLOGGED ADD CONSTRAINT UC_USERSLOGGED_PK PRIMARY KEY (ID);
